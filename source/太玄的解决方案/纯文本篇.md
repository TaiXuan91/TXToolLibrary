# 纯文本篇

## 纯文本（Plain Text）简介

文本文件最基本，最常用，也非常简单的一类的文件。浏览和编辑文本文件是基础中的基础。

为了和图文混排，字体样式繁多的文本类文件相区别，我们称不包含任何格式信息或非图像信息（仅仅包含编码为二进制数的文字符号）的文本文件为纯文本（Plain Text）。具体来说，在Word类软件中所编辑的就是富文本，而大多数程序源码则是以纯文本的形式编写和存储的。

当然，如果你喜欢也可以用纯文本来写小说，记日记什么的。只不过，大多数普通用户都选择了界面更为友好的软件。所以目前，纯文本的编辑和纯文本相关不再是计算机用户的必修课。只有做编程相关工作的人才会接触多一些。

这一篇文章将介绍几款编辑纯文本的工具，以及一些和纯文本相关的知识点。

## 字符编码

字符是人类的发明，用平面图案来表示、记录信息。计算机发明后，人类开始使用计算机处理文字信息。具体做法当然不是试图让计算机仿照人类写字直接在磁盘上刻出人类能识别的符号。而是在常用的字符和计算机所能处理的二进制数之间建立映射关系。这样就能把处理字符串（字符组成的序列）的问题转化为算术和逻辑的问题。

不过，由于语言、国别、维护团体等方面的原因，历史上出现过众多的编码方案。不同的编码方案中同一个字符可能对应不同的数字，或者有的字符在有的方案中就根本没有被编码。这一度给信息交流带来过麻烦。不过现在这种问题越来越不算是一个问题。目前需要重点了解的只有——ASCII和UTF-8。其中UTF-8还兼容ASCII，所以，其实只需要了解一种。

### Unicode

作为一个额外的小知识，我顺便提及一下Unicode。Unicode也可以称为“Universal Coded Character Set”。为了结束各个国家，各个语种只为自己的语言字符编号的混乱局面。由国际组织主持编订了Unicode编码表。旨在为每一个人类语言符号提供一个独一无二的编码。无论拉丁字母，汉字，数学符号还是表情符号都能在表中查到。而且这个编码表会不断更新，以求不断补充完善。如果所有语言的文本文件在编码的时候都遵从Unicode的规定，就不会存在字符编码冲突的问题。

但是注意，Unicode只是一个字符表。表中尽量包含所有人类所用的语言符号，并且每一个字符都有一个独一无二的编码。但是这不意味着我们在计算机中必须直接用Unicode的字符编号来存储字符。直接用Unicode存储起码存在两个问题：

1. Unicode的符号总量一直在增长，需要用几位数字并不确定。可能这几年用六位二进制数就够了，过几年用八位二进制数都不够。
1. 对于所用字符比较少的语言来说很多位是没有必要的。比如英文只用26个字母的大小写加一些标点符号。其实八位二进制足够了。但是Unicode字符编码的全长可远远不止八个二进制位。

### UTF

UTF全称是Unicode Transformation Format。这是一套将Unicode字符编号转化为变长编码的方案。根据编码长度的基本单位不同，分为好几个版本。如果以8位（1个字节）为基本长度单位，那么就是UTF-8。如果以16位（2个字节）为基本长度单位，那么就是UTF-16。如果以32位（4个字节）为基本长度单位，那么就是UTF-32。我们以最普及，最常用的UTF-8为例介绍。

UTF-8以8位为基本长度单位。所以最短的UTF-8编码，也是8位表示一个字符。而排号比较靠后的编码就会比较长。当8位二进制数快用尽时，就再加上8位。当16位二进制数也快用进时就再加上8位。当24位二进制数又快用进时就再加上8位。再不够用就再加长。但是每次加长都是以8位为一个单位。

具体从Unicode编号到若干个字节组成的编码的转换方法见维基百科上的[UTF-8](https://en.wikipedia.org/wiki/UTF-8)条目。

几点注意事项：

1. UTF-8，UTF-16，UTF-32之间并不能直接相互转化。因为所采用的长度单位不同，所以最终转换出来的编码大概率不同。
1. 由于微软的Windows系统中一直用“Unicode”称呼UTF-16，所以造成了非常大的混淆。一定要明确一个字符的UTF-16编码不等同于其Unicode编号。但是在Windows系统中有的写着Unicode的地方实际上是指UTF-16。

### BOM的问题

现在一般的计算机都以8位为一个字节。所以UTF-16以上的编码方案（长度单位大于等于16的UTF编码方案）中都存在一个存储顺序的问题。比如UTF-16中每一节16位的编码都要拆成2个字节存储，占用2个字节的相邻内存单元。可以把高8位存储在高地址号的单元中，也可以反过来把高8位存储在低地址号的内存单元中。这样就又造成了分歧和不统一。不过大部分这种细节都被操作系统或者文本编辑器屏蔽了。作为用户倒是不用太操心这种问题。

为了说明存储顺序的问题，一般会在这些编码的文件头中加入BOM（Byte Order Mark）。也就是用开头几个字节的内容表示编码的存储方式。UTF-8也允许在文件头加入BOM。但是由于UTF-8根本不存在字节存储顺序的问题，所以不加BOM才是常用形式。一般情况下，不建议保存为带BOM的UTF-8。我们说到UTF-8的时候也一般是指不带BOM的形式。

之所以UTF-8的BOM成了一个问题，是因为一些Windows上的软件非要给UTF-8加上BOM。这样保存的文件拿到其他系统，用默认不带BOM的软件打开就会遭遇麻烦。

### ASCII

ASCII是一套早在用电传打字机的时代就制定出来的一套字符编码方案。ASCII不是变长编码，1个字符8位二进制数。但是最高位留空，实际上只用了128个编号。出于尽量兼容已有编码方案的考虑，UTF-8的前128个字符和ASCII是基本一致的。

ASCII在制定时除了表示可以书写打印的所谓“可打印字符”（Printable Characters），还包括了一些控制打字机的控制命令。但是随着电传打字机的废弃，这些命令也大多停用了。虽然编号仍然留在ASCII中，但现在基本用不到。

目前仍然在用的几个控制符号在字符终端中被重新赋予了意义。关于这些控制字符在字符终端的意义请参考[VT-100字符终端的使用说明](https://vt100.net/docs/vt100-ug/)。

为了写代码方便，C语言中有一些通用的转义字符串被用来表示它们。比如`\t`表示水平制表，`\n`表示换行，`\r`表示回车。大部分编程语言中表示这些控制字符的方法都和C语言一致。一些文档或者手册中则用caret notation的约定来表示不可打印的控制字符。详细可以在维基百科的[ASCII](https://en.wikipedia.org/wiki/ASCII)条目中查到。

### 换行问题

电传打字机把换行打字分解为打字头回到最左端和纸张移动一行这两个动作。对应于这两个动作，分别使用`\r`和`\n`两个控制命令表示。到了计算机时代，字符终端也可以显示换行。但是工程师们在怎么表示换行的问题上产生了分歧。主流的观点就用三种。一种延续打字机的做法用`\r\n`表示（Windows的做法），一种认为只用`\r`就够了（Mac的做法），一种认为只用`\n`就够了（Unix，Linux的做法）。另外还有奇葩想用`\n\r`表示。

这种争论是永远没有终点的。主流的编辑器一般兼容以上所有的表示方法。我个人的意见是和Unix/Linux保持一致，使用`\n`。

>**吐槽**
>
>微软真的是麻烦制造者。换行符的问题，BOM的问题，混淆UTF-16和Unicode的问题都和微软的Windows有关。

### 编码和信息量的问题

字符编码的长度会影响到文本文件的大小。比如一个汉字在GBK中占2个字节，但在UTF-8中占3个字节。这样用UTF-8编码保存的文本是GBK格式汉字文本的约1.5倍。

但是，个人仍然建议所有非英文文本都用UTF-8保存，尤其是一些存在国际交流的场合。否则很可能遇到编码识别不了的尴尬。

而且在现在，由于编码方式造成的文件大小的差异其实无关紧要。一方面存储器很便宜了，没必要锱铢必较。另一方面，可以压缩来减少文件占用的空间。根据我的实验，GBK编码的汉字文本和UTF-8编码的汉字文本压缩后体积差不多大。因为虽然编码格式不同，但是信息量是差不多的。UTF-8中虽然汉字占了3个字节，但是每个汉字的UTF-8编码的最高几位都是相同的。压缩的时候这些重复的东西就会被压缩掉。

### 小节

综上本节所述，推荐的文本编码要符合以下要求：

1. UTF-8编码（不带BOM）。
1. LF（`\n`）表示换行。

由于UTF-8可以视为ASCII的超集，所以ASCII编码的纯英文文本也可以视为是UTF-8编码的。

## 工具定位

**纯文本浏览器** ：用于浏览查看纯文本文件。由于现代的文本编辑器大都有浏览功能，单纯的纯文本浏览工具已经很少了。如果你担心用纯文本编辑器查看文件的时候不小心修改了文件，可以把文件设置为只读文件或者通过只读模式打开。（还是有一些编辑器不太重视浏览功能的，比如流式编辑器grep，awk和sed。）

**纯文本编辑器** ：用于创建，编辑，查看纯文本文件的工具。这一期我们着重介绍文本编辑器，因此不会过多设计包含了文本编辑功能的集成开发环境等工具。

## 工具和方案

### Less

Less是一款纯文本浏览器，几乎是Linux发行版的标配。它的作用就是分页显示纯文本文件。

一般的Linux发行版中会自带Less.如果没有自带的话可以通过包管理软件安装,包名是less.

`less`命令后加要打开的文件名作为参数就可以打开文件。例如：

```shell
less readme.txt
```

如果给与的文件不是一个标准的文本文件（例如故意输入一个二进制文件的路径）,那么less也可以按照文本文件来解析显示。

进入阅读界面后，使用上下左右方向移动。PageUp和PageDown用于上下翻页（也可以使用空格向下翻页，用b键向上翻页）。Home和End则用于定位到文首，文尾。

按h键打开帮助信息。按q键退出Less。

除了直接读取文件,Less也接受流输入.例如:

```shell
ls | less
```

```shell
man bash | less
```

Less胜在小巧，启动快。在使用Linux命令行时，如果仅仅是查看文件，一般还是会用Less，而不是启动文本编辑器。

信息总结：

* 功能定位：纯文本浏览器
* 平台支持：Linux, Windows, Mac
* 开源
* 拓展性：未知
* 费用：免费
* 网址：<http://www.greenwoodsoftware.com/less/download.html>
* 意见：非常简单小巧的文本查看器。当然你不用，也不会影响什么。其功能完全可以被编辑器取代。

### 其他命令行工具

util-linux等工具包也提供一些和纯文本浏览，编辑有关的工具（例如Less的前辈More）。这些工具要么使用频率相对低一些，要么就是和流式编辑有关。在这里就不详细介绍了。

### Vi/Vim

Vi是一款文本编辑工具。Vim则可以看作是vi的功能增强版。并且Vim兼容Vi的所有命令。虽然这是两个软件，但是由于相近的使用方式，经常把它们放到一起说。这里我们着重介绍Vim。

Vim是一款非常小巧的纯文本编辑工具.几乎在所有的Linux系统上都能找到Vim(或者Vi).对于不使用命令行或者Linux的人,它也提供图形化界面版和其他系统版.

但是，Vim的操作方式和其他文本编辑器的差距非常大。它比较少使用Ctrl，Alt等控制键的组合快捷键。在通常的操作中用户需要在插入模式和命令模式下来回切换。插入模式下各种字母和数字键表示输入对应的字符，而在命令模式下这些键则表示复制粘贴，移动光标，删除搜索等操作命令。所以计划以Vim（或者Vi）为主力编辑器的萌新们请三思。

不过，由于Vi/Vim几乎能在任何Linux发行版上找到，作为一个经常和服务器或者类Unix系统打交道的人还是多少了解一下基础用法比较好。最起码会打开文件，移动光标，修改内容 ，保存退出。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Linux, Windows, Mac
* 开源
* 拓展性：支持插件拓展
* 费用：免费
* 网址：<https://www.vim.org/>
* 意见：学习类Unix系统或者配置服务器的人多少要会一点。不畏惧陡峭学习曲线的萌新可以尝试用Vi/Vim作为主力编辑器。

### GNU Emacs

现在一般所说的Emacs是指GNU Emacs。相对于Vim的小而精，Emacs的特色是大而全。Emacs的启动速度相对Vim要慢很多。但是一个Emacs的粉丝会告诉你，你根本不需要频繁启动和退出Emacs。你可以在Emacs中调用shell，编译源码，debug程序。你甚至可以用Emacs作为图形化界面的窗口管理器（我试过）。

对初学者来说，Emacs相比Vim最大的优势就在于Emacs的操作思路和记事本，Word等是一致的。虽然快捷键不太一样，但是都是以Ctrl，Meta（Alt）的组合键为主。字母和数字键按下就表示输入字符。方向键，退格键也是默认可用的（Vi默认不支持方向键和退格键）。在有鼠标的情况下，用起来就像一个高级版的记事本。

深入了解之后，Emacs相对来说可以玩的东西比较多。经常有人说Emacs的学习曲线越到后边越奇怪，你可能会在Emacs中做一些根本不属于文本编辑器功能范围内的事情。如果你喜欢这种摸索新玩法的感觉可以试一试Emacs。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Linux, Windows, Mac
* 开源
* 拓展性：支持插件拓展
* 费用：免费
* 网址：<https://www.gnu.org/software/emacs/>
* 意见：功能丰富，但相对Vim来说体态臃肿。学习Emacs不需要改变操作思路，相对容易上手。不单纯是一个文本编辑器，可以开发的玩法很多。

### GNU nano

据说有的老师不愿意介入Vim和Emacs的圣战，就在课上讲授nano。nano就属于那种上限不高，下限也不太低的编辑器。你不会因为没有背会长长的快捷键表而无法使用nano，但是也不会因为操作熟练而提升太多的效率。

nano相对小巧，功能精当，操作思路又和记事本一样，按键输入，组合键控制。所以nano真正是一个Linux字符终端版的记事本。

如果你只是偶尔修改一下配置文件什么的。那么除了被用其他编辑器的“大神”鄙视以外也没什么不好。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Linux
* 开源
* 拓展性：未知
* 费用：免费
* 网址：<https://www.nano-editor.org/>
* 意见：就是Linux字符终端版记事本，还要说更多么？

### gedit

之前介绍的编辑器和浏览器主要在字符终端上用（虽然Vim和Emacs都有图形化界面版）。对于仅仅是写点东西，不用经常通过字符终端配置服务器的用户来说，当然是图形化界面的软件用着更舒服。除了用Vim或Emacs的图形化界面版，你也可以选择专门为图形化界面打造的编辑器。

例如gedit。gedit是GNOME桌面环境的一个子项目。提供了基本的纯文本编辑功能，编程语言语法高亮，拼写查错，和一些拓展接口。它是GNOME桌面环境的内置文本编辑器，地位大致相当于Windows的记事本。但是gedit是可以单独安装或者卸载的（可以在其他桌面环境下安装gedit）。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Linux
* 开源
* 拓展性：支持插件拓展
* 费用：免费
* 网址：<https://wiki.gnome.org/Apps/Gedit>
* 意见：就是GNOME桌面环境版记事本，而且比记事本功能还强大一些，还要说更多么？

### 记事本（Microsoft Notepad）

虽然我不想说，但是Windows预装的记事本确实也算是一种选择。但是这个记事本做得真是非常不走心，而且还不能卸载。由于Windows并不把编程视为用户的基本需求，所以记事本也没有语法高亮功能。虽然用记事本写代码也不是不行，但是没有自虐倾向且精神正常的人很少这么做。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Windows
* 不开源
* 拓展性：未知
* 费用：随Windows附赠，似乎不单独出售。
* 网址：微软似乎没有为这个Windows内置小程序设置单独主页。
* 意见：记事本，还要说更多么？要是能卸载它，我电脑里根本就不会出现记事本。

### Visual Studio Code

可能是微软在Windows中捆绑记事本后觉得良心过不去。所以又推出了一个开源跨平台高性能易拓展的纯文本编辑器——Visual Studio Code。简称VSCode，命令行的默认启动命令是`code`。

Visual Studio是微软的集成开发环境。将这款编辑器命名为Visual Studio Code可能是希望它作为Visual Studio的轻量级替代品。这样用户们不需要看个十几行的代码都花五分钟启动Visual Studio。

VSCode和记事本、gedit之类的编辑器不一样。在功能性和精简小巧的取舍中，VSCode更偏向于功能性一些。它内置了对多种编程语言的支持，Debug功能接口，git支持，甚至还有Markdown预览之类的功能。如果你有兴趣也可以以VSCode为核心打造一个IDE。

以前，在拿VSCode和Atom比较的时候，很多人会说VSCode的插件生态不如Atom好。但是几年下来，这方面的差距对于普通用户来说影响不是很大。首先，VSCode每次更新都会完善增补自身的功能，很多功能不需要插件就能实现。其次，VSCode的插件也不少了，其中还有很多是微软自己在维护的高质量插件。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Linux, Windows, Mac
* 开源
* 拓展性：支持插件拓展
* 费用：免费
* 网址：<https://code.visualstudio.com/>
* 意见：个人认为是图形化界面下首选的纯文本编辑器。功能强大，插件丰富，而且启动也比较迅速，资源占用相对较少。另外更新很频繁不知道算不算一个优点。

### Atom

Atom和Visual Studio Code大致可以算是同类产品。只不过VSCode主要由微软公司维护，Atom主要依靠社区维护。VSCode更倾向于优化自身，Atom更重视拓展插件的支持。

Atom我用过几天，但是相比于当时的VSCode来说，Atom比较慢，而且资源占用比较多。据说最近Atom的速度有很大提升，我也没有尝试，不知道是不是真的这样。

另外，个人感觉Atom在安装即用上相对VSCode差一些。安装以后需要配置一番才能用得比较舒服。

信息总结：

* 功能定位：纯文本编辑器
* 平台支持：Linux, Windows, Mac
* 开源
* 拓展性：支持插件拓展
* 费用：免费
* 网址：<https://atom.io/>
* 意见：源自社区的力量。就是有点慢。

### 其他图形化界面编辑器

一个简单的纯文本编辑器其实并不是一个很复杂的程序。所以有太多记事本那样的编辑器，我就不一一介绍了。

还有一些知名的纯文本编辑器由于我没怎么用过，不好评价，所以也不在这里列出了。

### 私货时间

文本编辑器只是一个工具，不应该把太多时间浪费在试遍所有编辑器上。深入掌握两三款编辑器就足够了。

如果用图形化界面那就在VSCode和Atom中选一个。如果用字符终端那就在Emacs和Vim中选一个。

如果有选择困难症，那么就直接VSCode。
