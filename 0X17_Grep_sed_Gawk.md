# 0X17 Grep sed Gawk

## 简介

grep, sed, awk是流式编辑中的三基友.GNU Grep, GNU sed, Gawk分别是他们的GNU版.

所谓的流式编辑不同于我们用记事本或者vim修改文本.用记事本或者vim修改文件,就像在纸上写字,把整个文件铺在桌子上,然后哪里需要修改就把注意力集中到哪里.

而流式编辑中把文件看作一个输入流.流式编辑器更像一个筛子而不是一个可以在纸上随意写画的笔.我们给编辑器提一个要求(比如"查找出所有带'GNU'的字段","把'NBA'全部换成'CBA'"或者"在每一行末尾追加句号"),然后把文件扔进去.流式编辑器就会从头到尾过滤文件,把符合修改要求的地方改掉或者提取出来(也是通过文件流的方式输出).

这样当然有好处也有坏处.坏处就是非常不直观.不能像vim或者记事本那样边看,边想,边改,想到哪改到哪.也不适合修改比较的文件.例如在debug一份程序源码的时候,可能只有几段文字需要反复修改.而如果用流式编辑,每次都过滤整个文件显然很浪费时间.

好处就是非常适合机器自动化处理.在自动配置服务器,填写或者查看各种格式化的配置信息的时候,流式编辑显得非常高效.另外流式编辑也比较容易处理超大的文件.如果要用记事本打开一个20MB的文件,就需要把这20MB的文件全部载入内存.而流式编辑中,文件已经处理过的部分和很久以后才会处理到的文本都是不必要载入内存的.只有当前'筛子'会'筛'到的部分需要载入内存.这样就可以一边载入,一边编辑,一边卸载.

## 安装

虽然这些工具很常用,但是对于不经常做Linux系统管理的普通用户来说并不是必备的工具.如果你的发行版上没有安装这些工具,需要的时候可以通过包管理软件来安装.包名分别是grep, sed, gawk.

另外如果你不做Linux系统管理员,实在没有必要在这三个工具上花费太多时间.因为他们能做的,其实Python或者Lua也能做到.

## grep

grep用于查找.在输入流中查找指定的模式,并把匹配结果从输出流输出.例如查找一个文件中所有带'dog'的行:

```shell
grep 'dog' mytext
```

它也接受管道输入:

```shell
ls /bin | grep 'b'
```

注意,grep, sed, awk都支持正则表达式.后边不再赘述.

```shell
ls /bin | grep '^b'
```

上边这条命令查找/bin中所有以'b'开头的文件.

## sed

sed用于编辑(当然也能查找).它在输入流中查找指定模式,并作编辑(替换,删除,追加等),然后把结果输出到输出流(默认不改变原文件).例如这条命令把文本中所有的'int'换成'float'.

```shell
sed 's/int/float/' hello.c
```

## awk

sed的编辑功能用于处理简单的替换还可以,但是用于处理高度格式化的文件就比较繁琐.awk在处理表格等高度格式化的流式文本则要得心应手得多.

awk的命令其实是一门编程语言.你可以把复杂的处理过程写成awk脚本.它要比sed和grep复杂.但是就它增强的功能来看,这种复杂是值得的.

## 关于手册

在这三款软件的官网上都能找到在线手册.

在你的电脑上使用info命令则可以查看他们的离线手册.如果查不到对应的info手册.则尝试用包管理软件安装gawk-doc等包名.

## 资料

* [GNU Grep官网](https://www.gnu.org/software/grep/)
* [GNU sed官网](https://www.gnu.org/software/sed/)
* [Gawk官网](https://www.gnu.org/software/gawk/)
* [Linux Administration with sed and awk](https://www.pluralsight.com/courses/linux-administration-sed-awk)

Linux Administration with sed and awk是一个关于grep,正则表达式,sed和awk的教程.B站也有搬运:

* [Linux Administration with sed and awk(站内搬运)](https://www.bilibili.com/video/av9273402/)
